# 国密 sm1/sm2/sm3/sm4

# SM3

## SM3 算法自检原理

- 对预置明文进行摘要计算，计算结果与预置杂凑值进行比较，结果相同则自检通过，否则自检失败。
- 如果自检失败，结果写入日志，业务无法启动核准的安全功能。

## SM3 算法自检数据

- 预置明文   `616263`
- 预置杂凑值 `66c7f0f4 62eeedd9 d1f2d46b dc10e4e2 4167c487 5cf2f7a2 297da02b 8f4ba8e0`

# SM4

## SM4 ECB 算法自检原理

- 使用预置密钥对预置明文进行 ECB 模式 SM4 加密计算，加密结果与预置密文进行比较，结果相同则加密自检通过，否则加密自检失败。
- 再使用预置密钥对预置密文进行解密运算，解密结果与预置明文比对，一致则解密自检通过，否则解密自检失败。
- 加密自检和解密自检都通过则 SM4 算法 ECB 模式自检通过。
- 如果自检失败，结果写入日志，业务无法启动核准的安全功能。

## SM4 ECB 算法自检数据

- 预置明文   `01 23 45 67 89 ab cd ef fe dc ba 98 76 54 32 10`
- 预置密钥   `01 23 45 67 89 ab cd ef fe dc ba 98 76 54 32 10`
- 预置密文   `68 1e df 34 d2 06 96 5e 86 b3 e9 4f 53 6e 42 46`

## SM4 CBC 算法自检原理

- 使用预置密钥和预置 IV 对预置明文进行加密，加密结果与预置密文进行比较，结果相同则加密自检通过，否则加密自检失败。
- 再使用预置密钥和预置 IV 对预置密文进行解密运算，解密结果与预置明文比对，一致则解密自检通过，否则解密自检失败。
- 加密自检和解密自检都通过则 SM4 算法 CBC 模式自检通过。
- 如果自检失败，结果写入日志，业务无法启动核准的安全功能。

## SM4 CBC 算法自检数据

- 预置明文   `01 23 45 67 89 ab cd ef fe dc ba 98 76 54 32 10`
- 预置密钥   `01 23 45 67 89 ab cd ef fe dc ba 98 76 54 32 10`
- 预置 IV    `01 23 45 67 89 ab cd ef fe dc ba 98 76 54 32 10`
- 预置密文   `26 77 f4 6b 09 c1 22 cc 97 55 33 10 5b d4 a2 2a f6 12 5f 72 75 ce 55 2c 3a 2b bc f5 33 de 8a 3b`

## SM4 CTR 算法自检原理

- 使用预置密钥和预置计数器值对预置明文进行加密，加密结果与预置密文进行比较，结果相同则加密自检通过，否则加密自检失败。
- 再使用预置密钥和预置计数器值对预置密文进行解密运算，解密结果与预置明文比对，一致则解密自检通过，否则解密自检失败。
- 加密自检和解密自检都通过则 SM4 算法 CTR 模式自检通过。
- 如果自检失败，结果写入日志，业务无法启动核准的安全功能。

## SM4 CTR 算法自检数据

- 预置明文      `01 23 45 67 89 ab cd ef fe dc ba 98 76 54 32 10 01 23 45 67 89 ab cd ef fe dc ba 98 76 54 32 10`
- 预置密钥      `01 23 45 67 89 ab cd ef fe dc ba 98 76 54 32 10`
- 预置计数器    `01 23 45 67 89 ab cd ef fe dc ba 98 76 54 32 10`
- 预置密文      `69 3d 9a 53 5b ad 5b b1 78 6f 53 d7 25 3a 70 56 bf b9 61 0e b9 d1 5b 16 2d e1 61 75 3a a7 ab 84`

# SM1 

## SM1 ECB 算法自检原理

- 使用预置密钥对预置明文进行 ECB 模式 SM1 加密计算，加密结果与预置密文进行比较，结果相同则加密自检通过，否则加密自检失败。
- 再使用预置密钥对预置密文进行解密运算，解密结果与预置明文比对，一致则解密自检通过，否则解密自检失败。
- 加密自检和解密自检都通过则 SM1 算法 ECB 模式自检通过。

## SM1 ECB 算法自检数据

- 预置明文   `01 23 45 67 89 ab cd ef fe dc ba 98 76 54 32 10` (十六进制)
- 预置密钥   `01 23 45 67 89 ab cd ef fe dc ba 98 76 54 32 10` (十六进制)
- 预置密文   `92 03 a0 10 b5 0c 4e 3c a2 89 73 08 a9 d4 8c 2e` (十六进制)

## SM1 CTR 算法自检原理

- 使用预置密钥对预置计数器和预置明文进行加密，加密结果与预置密文进行比较，结果相同则加密自检通过，否则加密自检失败。
- 再使用预置密钥对预置计数器和预置密文进行解密运算，解密结果与预置明文比对，一致则解密自检通过，否则解密自检失败。
- 加密自检和解密自检都通过则 SM1 算法 CTR 模式自检通过。

## SM1 CTR 算法自检数据

- 预置明文      `01 23 45 67 89 ab cd ef fe dc ba 98 76 54 32 10 01 23 45 67 89 ab cd ef fe dc ba 98 76 54 32 10` (十六进制)
- 预置密钥      `01 23 45 67 89 ab cd ef fe dc ba 98 76 54 32 10` (十六进制)
- 预置计数器    `01 23 45 67 89 ab cd ef fe dc ba 98 76 54 32 10` (十六进制)
- 预置密文      `93 20 e5 77 3c a7 83 d3 5c 55 c9 90 df 80 be 3e 3b e2 06 52 7f 03 95 72 80 1b 23 ed 76 7e 0f ad` (十六进制)

# SM2

## SM2 签名/验签自检算法原理

- 对预置签名值使用预置公钥进行验签运算，验签通过则 SM2 验签自检通过，否则验签自检失败；
- 对预置待签名数据使用预置私钥进行签名计算，再用预置公钥对签名结果进行验签计算，验签通过则 SM2 签名自检通过，否则签名自检失败。
- 验签自检和签名自检都通过，则 SM2 签名验签自检通过。
- 如果自检失败，结果写入日志，业务无法启动核准的安全功能。

## SM2 签名/验签自检数据

- 预置待签名数据	`616263`
- 预置公钥
```
f0 80 36 1d 43 e6 5b 47 e8 f0 d2 c1 5e 99 98 5e 
d7 86 ed 29 30 8d ff ab b5 f0 43 21 6a d6 87 c2 
50 73 3e 09 e0 1a 48 f3 ba a5 cd 7e 90 35 fd 76 
6c eb 7b fd 4d 23 48 a2 66 94 2d bc 10 e4 84 56
```

- 预置私钥
```
b1 e7 fd cb 32 12 1c 67 3a b7 99 e5 ed 7b d7 86
60 a3 a1 54 30 55 db 4a 0d 94 d0 ef b6 98 56 73
```

- 预置签名值
```shell
2d 93 24 da e2 1f c7 71 61 e2 30 71
87 03 ea 23 1c 99 c0 00 27 82 80 4e 2b 78 ef a2
34 89 53 43 3e 39 c3 d2 4d 08 78 50 8d 04
55 72 2f 00 20 0e 35 4f47 6d 19 c8 83 a8 b2 5d
c2 00 e4 b8 51 ff
```

- 签名者ID	`31323334353637383132333435363738`
- 签名数据	`98DF81E34CDE74A9A0562F1802B96A15EAD3E4ED22AC4DC4AAD2B90836245A1A`

## SM2 加密/解密自检算法原理

- 对预置密文使用预置私钥进行解密运算，解密结果和预置明文进行比对，一致则SM2解密自检通过，否则解密自检失败；
- 对预置明文使用预置公钥进行加密计算，再用预置私钥对加密结果进行解密计算，解密结果与预置明文比对，一致则加密自检通过，否则加密自检失败。
- 解密自检和加密自检都通过，则SM2加解密自检通过。
- 如果自检失败，结果写入日志，业务无法启动核准的安全功能。

## SM2 加密/解密自检数据

- 预置明文	`01 23 45 67 89 ab cd ef fe dc ba 98 76 54 32 10`
- 预置公钥
```shell
f0 80 36 1d 43 e6 5b 47 e8 f0 d2 c1 5e 99 98 5e 
d7 86 ed 29 30 8d ff ab b5 f0 43 21 6a d6 87 c2 
50 73 3e 09 e0 1a 48 f3 ba a5 cd 7e 90 35 fd 76 
6c eb 7b fd 4d 23 48 a2 66 94 2d bc 10 e4 84 56
```

- 预置私钥
```
b1 e7 fd cb 32 12 1c 67 3a b7 99 e5 ed 7b d7 86
60 a3 a1 54 30 55 db 4a 0d 94 d0 ef b6 98 56 73
```

- 预置密文
```
62 fc b4 be a6 01 bc 09 df 53 e5 8a
3a 2c d3 9e 12 7f e9 98 58 b3 7e 09 31 d9 1c 45
7d 87 85 bc 39 c3 f4 ae 17 d2 b1 62 5e 9b
15 1e bc 32 3f d0 a6 5f 6a 4e 56 54 69 47 4e 94
88 89 ac 1e fc 8e 83 f4 75 4e d8 2d 9e 57
c2 d8 d1 e2 a4 2a 1e e1 a3 ea b7 47 cc 2e 2f 3d
a6 b8 14 3f 31 01 2d 12ce e1 2f 18 10 11
80 7b f1 02 95 29 a0 cc 7b 57
```
